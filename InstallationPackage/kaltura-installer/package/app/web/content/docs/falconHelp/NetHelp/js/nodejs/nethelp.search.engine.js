(function(){function r(n){for(var u=[[11904,40959],[40960,42559],[42656,42783],[43008,43055],[43072,55295],[63744,64255],[65072,65103]],r,t,i=0;i<n.length;i++)if(r=n.charCodeAt(i),!(r<u[0][0]))for(t=0;t<u.length;t++)if(r>=u[t][0]&&r<=u[t][1])return!0;return!1}function y(n,i){var e=new Array(n.length+1),u,s,r,f,o;for(e[0]=-1,r=1;r<=n.length;r++)for(u=r;u>0;u--)if(e[r-u]&&(s=t(i,n.substr(r-u,u)),s!=-1)){e[r]=s+1;break}if(e[n.length]){for(r=n.length,f="";r>0;)o=i[e[r]-1],f=o+" "+f,r-=o.length;return f.substr(0,f.length-1)}return n}function s(n,t,i){for(var e="",f=n.split(" "),u=0;u<f.length;u++)(!i||r(f[u]))&&(f[u]=y(f[u],t));return f.join(" ")}function f(n,t){if(n=n.replace(/[-[\]{}()+.,\\^$|]/g,"\\$&").replace(/\*+/g,"\\w*").replace(/\?/g,"\\w").replace(/\s+/g,"\\s+"),n==="\\w*"&&(n="\\w+"),!r(n)&&!t){var f=n.length,i=/^(\w|\.|\\w)/,u=/(\w|\.|\*|\\w\+)$/;n=(i.test(n)?"\\b":"")+n+(u.test(n)?"\\b":"")}return n}function v(n,t){var i=n.length-t.length;return i<0?1:i>0?-1:0}function a(n,t,i,r,u){var c=t.length+1,s=i.length+1,h,e,o,l,f;if(n[u][s]&&n[u][s]>r)return r+1;for(u++,e=u;e<c;e++){for(h=c+s,o=n[e],l=n[e-1],f=1;f<s;f++)o[f]=Math.min(l[f-1]+(t.charCodeAt(e-1)==i.charCodeAt(f-1)?0:1),Math.min(l[f],o[f-1])+1),o[f]<h&&(h=o[f]);if(o[s]=h,h>r)return r+1}return n[c-1][s-1]}function n(n,t,i){for(var u,r=0;r<Math.min(n.length,i);r++)if(u=n.charCodeAt(r)-t.charCodeAt(r),u!=0)return u;return n.length<i?-1:0}function o(t,i,r){for(var u=0,e=t.length-1,f;e>u;)f=Math.round((u+e)/2),n(t[f],i,r)<0?u=f+1:e=f-1;return u<t.length-1&&n(t[u],i,r)!=0&&u++,u<t.length&&n(t[u],i,r)==0?u:-1}function e(t,i,r){for(var u=0,e=t.length-1,f,o;e>u;)f=Math.round((u+e)/2),o=t[f].charCodeAt(0),n(t[f],i,r)<=0?u=f+1:e=f-1;return(u>=t.length||n(t[u],i,r)!=0&&u>0)&&u--,u<t.length&&n(t[u],i,r)==0?u:-1}function t(n,t){for(var r=0,u=n.length-1,i;u>r;)if(i=Math.round((r+u)/2),n[i]<t)r=i+1;else if(n[i]>t)u=i-1;else return i;return r==u&&n[r]==t?r:-1}function p(n){return n.indexOf("?")>-1||n.indexOf("*")>-1}function c(n){for(var r=[],i=[],t=0;t<n.length;t++)r[n[t]]||(i[i.length]=n[t],r[n[t]]=!0);return i}function u(){this.defineOperators("AND","OR","NOT")}function i(n,t,r){var o,u,f,e;if(!this||!this._prepare)return new i(n,t,r);if(this.engine=n,r||(r={},t=this._prepare(t,r)),t=t||"",o=t.indexOf(n.d2hQuotePrefix)==0&&r[t]!=null||t.toLowerCase().indexOf((n.searchNotInSpaces+n.d2hQuotePrefix).toLowerCase())==0&&r[t.substring(n.searchNotInSpaces.length,t.length)]!=null,f=!1,o?(f=t.toUpperCase().indexOf(n.searchNotInSpaces)===0,f&&(t=t.substring(n.searchNotInSpaces.length,t.length)),this.type=0,u=r[t].split(" "),t=r[t]):(u=t.split(new RegExp(n.searchOrInSpaces.replace(/[-[\]{}()*+?.,\\^$|]/g,"\\$&"),"gi")),u.length==1?(u=t.split(new RegExp(n.searchAndInSpaces.replace(/[-[\]{}()*+?.,\\^$|]/g,"\\$&"),"gi")),this.type=2):this.type=1,u.length==1&&(f=t.toUpperCase().indexOf(n.searchNotInSpaces)===0,f&&(t=t.substring(n.searchNotInSpaces.length,t.length)),u=t.split(" "),this.type=2),u=c(u)),u.length>1||o)for(this.children=new Array(u.length),e=0;e<u.length;e++)this.children[e]=new i(n,u[e],r),o&&(this.children[e].type=0);f&&(u.length==1||o?this.not=!0:this.children[0].not=!0),this.value=t.toLowerCase()}var h=typeof process!="undefined"?process:{},l=h.versions&&h.versions.node;u.prototype={g_sTopics:[],g_sWords:[],g_sWordTopics:[],g_sStopWords:[],g_sAliases:[],quotes:[],aliasesHT:[],wordTopicsLen:[],searchAnd:"",searchOr:"",searchNot:"",searchAndInSpaces:"",searchOrInSpaces:"",searchNotInSpaces:this.searchNot+" ",d2hQuotePrefix:"_d2hQuote",init:function(n,t){var i=this;n&&(i.g_sTopics=n.topics||[],i.g_sWords=n.words||[],i.g_sWordTopics=n.wordTopics||[],i.g_sStopWords=n.stopWords||[],i.g_sAliases=n.aliases||[]),t&&i.defineOperators(t.and,t.or,t.not),i.initAliases(),i.initPrefix()},start:function(n){var e=this,t=new i(e,n),f,r,u,s;t.execute();var c=t.getQueryString(!1),o=t.getQueryString(!0),h=[];if(c==o&&(o=""),t.docs)for(t.docs=e.calcHistogram(t.docs),f=0,r=0;r<t.docs.length;r++)u=e.g_sTopics[t.docs[r][0]],u&&(h[f]={url:u[0],text:u[1],id:"searchResult"+f++});return s={original:c,correcting:o,items:h,words:t.getWords(!0)}},defineOperators:function(n,t,i){var r=this;r.searchAnd=n.toUpperCase(),r.searchOr=t.toUpperCase(),r.searchNot=i.toUpperCase(),r.searchAndInSpaces=" "+r.searchAnd+" ",r.searchOrInSpaces=" "+r.searchOr+" ",r.searchNotInSpaces=r.searchNot+" "},getWords:function(){var i=this,t=[],n;for(t.length=i.g_sWords.length,n=0;n<i.g_sWords.length;n++)t[n]=i.g_sWords[n];return t.sort(v),t},getAliases:function(n){var r=this,i,t,u;if(r.initAliases(),i=r.aliasesHT[n],i&&typeof i!="function")for(t=r.g_sAliases[i[0]],u=1;u<i.length;u++)t=r.mergeSimple(t,r.g_sAliases[i[u]]);else t=new Array(1),t[0]=n;return t},initPrefix:function(){var n=this,t;if(n.g_sWords&&n.g_sWords.length)for(n.wordTopicsLen=new Array(n.g_sWords.length),t=0;t<n.g_sWords.length;t++)n.wordTopicsLen[t]=n.getWordTopicsItemLength(t)},calcHistogram:function(n){for(var u=this,r=[],i,t=0;t<n.length;t++)i="x"+n[t][0],r[i]?(r[i]=new Array(r[i].length+n[t].length),n[t]=null):r[i]=n[t];return n.sort(function(n,t){return u.sortByCounterNumber(n,t)}),n},sortByCounterNumber:function(n,t){var u,f,i,r;return n==null?1:t==null?-1:(u=this,f=n.length-t.length,f==0)?(i=u.g_sTopics[n[0]][1],r=u.g_sTopics[t[0]][1],i>r)?1:i<r?-1:0:f<0?1:-1},getSimilarWord:function(n){var t,f,w,d,s;if(r(n))return n;var i=this,u=Math.round(.4+n.length/4),c=-1,k=-1,tt=o(i.g_sWords,n,1),it=e(i.g_sWords,n,1)+1,g=n.length,y=g+1,p=y+u,h=new Array(p),b=-1;if(tt==-1)return n;for(t=0;t<p;t++)h[t]=new Array(y+1),h[t][0]=t,h[t][y]=0;for(t=0;t<y;t++)h[0][t]=t;for(t=tt;t<it;t++){var v=i.g_sWords[t],l=i.wordTopicsLen[t],nt=v.length;if(!(Math.abs(nt-g)>u)&&(l!=1||i.aliasesHT[v])){if(p=nt+1,f=0,b!=-1)for(w=i.g_sWords[b],d=Math.min(w.length,u);f<d&&v.charCodeAt(f)==w.charCodeAt(f);)f++;(s=a(h,v,n,u,f),b=t,s>u||s==0)||(s<u||c==-1?(u=s,c=t,k=l):l>k&&(c=t,k=l))}}return c!=-1?i.g_sWords[c]:n},_aliasesInited:!1,initAliases:function(){var n=this,t,r,i;if(!n._aliasesInited){for(t=0;t<n.g_sAliases.length;t++)for(r=0;r<n.g_sAliases[t].length;r++)i=n.g_sAliases[t][r],n.aliasesHT[i]==null&&(n.aliasesHT[i]=new Array(1)),n.aliasesHT[i][n.aliasesHT[i].length-1]=t;n._aliasesInited=!0}},addAND:function(n){for(var i=this,r,u,t=n.length-i.searchNotInSpaces.length-1;t>=0;t--)n.substring(t,t+i.searchNotInSpaces.length+1).toUpperCase()==" "+i.searchNotInSpaces&&(r=t-i.searchAndInSpaces.length+1,u=r>=0?n.substring(r,t+1).toUpperCase()==i.searchAndInSpaces:!1,u||(r=t-i.searchOrInSpaces.length+1,u=r>=0?n.substring(r,t+1).toUpperCase()==i.searchOrInSpaces:!1),u||(n=n.substring(0,t)+" "+i.searchAnd+n.substring(t,n.length)));return n},getDocID:function(n){return n[0]},invert:function(n){for(var i=this,o=n?n.length:0,s=i.g_sTopics.length-o,f=new Array(s),r=0,e=0,u=r<o?i.getDocID(n[r++]):i.g_sTopics.length,t=0;t<i.g_sTopics.length;t++)t<u?(f[e]=new Array(1),f[e][0]=t,e++):t==u&&(u=r<o?i.getDocID(n[r++]):i.g_sTopics.length);return f},intersect:function(n,t,i){var o,h;if(!n||!t)return null;for(var c=this,a=new Array(n.length),u=0,r=0,l=0;u<n.length&&r<t.length;)if(o=c.getDocID(n[u]),h=c.getDocID(t[r]),o==h){var e=1,f=1,v=1,s=[];if(s[0]=o,i)while(e<n[u].length&&f<t[r].length){for(n[u][e]==t[r][f]-1&&(s[v++]=t[r][f],e++,f++);e<n[u].length&&n[u][e]<t[r][f]-1;)e++;while(f<t[r].length&&t[r][f]<=n[u][e])f++}(!i||s.length>1)&&(a[l]=s,l++),u++,r++}else if(o<h)while(u<n.length&&c.getDocID(n[u])<h)u++;else while(r<t.length&&c.getDocID(t[r])<o)r++;return a.length>l&&(a.length=l),a},mergeSimple:function(n,t){if(n==null)return t;if(t==null)return n;for(var u=new Array(n.length+t.length),r=0,i=0,f=0;r<n.length&&i<t.length;)n[r]==t[i]?(u[f++]=n[r++],i++):u[f++]=n[r]<t[i]?n[r++]:t[i++];while(r<n.length)u[f++]=n[r++];while(i<t.length)u[f++]=t[i++];return u.length>f&&(u.length=f),u},mergeDocs:function(n,t){var o,e;if(n==null)return t;if(t==null)return n;for(var s=this,i=new Array(n.length+t.length),f=0,u=0,r=0;f<n.length&&u<t.length;)o=s.getDocID(n[f]),e=s.getDocID(t[u]),o==e?(i[r]=new Array(2),i[r++]=s.mergeSimple(n[f++],t[u++])):i[r++]=o<e?n[f++]:t[u++];while(f<n.length)i[r++]=n[f++];while(u<t.length)i[r++]=t[u++];return i.length>r&&(i.length=r),i},getWordTopicsItemLength:function(n){for(var r=this,t=0,i=0;t<r.g_sWordTopics[n].length;)i++,t+=r.g_sWordTopics[n][t+1]+2;return i},getWordTopicsItem:function(n){for(var i=this,u=new Array(i.getWordTopicsItemLength(n)),t=0,f=0,r;t<i.g_sWordTopics[n].length;){for(u[f]=new Array(i.g_sWordTopics[n][t+1]+1),u[f][0]=i.g_sWordTopics[n][t],r=0;r<i.g_sWordTopics[n][t+1];r++)u[f][r+1]=i.g_sWordTopics[n][t+2+r];f++,t+=i.g_sWordTopics[n][t+1]+2}return u},searchInIndex:function(n,i){var u=this,h=n.indexOf("*"),c=n.indexOf("?"),nt=i&&(h>-1||c>-1),r,y,v,p;if(nt){var tt=new RegExp(f(n,!1),"gi"),b,s=null,g=c>-1,k=h>-1,w=k&&g?Math.min(h,c):Math.max(h,c),l=o(u.g_sWords,n,w),d=e(u.g_sWords,n,w)+1,a=n.length;if((n.charAt(0)=="*"||n.charAt(0)=="?")&&(l=0,d=u.g_sWords.length),l==-1)return null;for(r=0;r<n.length;r++)n.charAt(r)=="*"&&a--;for(r=l;r<d;r++)(y=u.g_sWords[r],v=y.length,v<a||!k&&v!=a)||(b=y.search(tt),b==0&&(s=s?u.mergeDocs(s,u.getWordTopicsItem(r)):u.getWordTopicsItem(r)));return s}return p=t(u.g_sWords,n),p!=-1?u.getWordTopicsItem(p):null},getWordsFromIndex:function(n){for(var r=this,i=[],u=new RegExp(f(n),"gi"),t=0;t<r.g_sWords.length;t++)r.g_sWords[t].search(u)>-1&&(i.length=i.length+1,i[i.length-1]=r.g_sWords[t]);return i}},i.prototype={value:"",children:null,type:0,not:!1,docs:null,_prepare:function(n,t){var f=this,i=f.engine,r,u;if(n){for(n=s(n,i.g_sWords,!0),r=0,n=n.replace(/[\.,;(){}[\]]/g," ").replace(/"([^"]+)"/g,function(n,i){var u=f.engine.d2hQuotePrefix+r++;return t[u]=i.replace(/\s+/g," ").replace(/^\s+/g,"").replace(/\s+$/g,""),u}).replace(/["]/g," "),r=0;r<i.g_sStopWords.length;r++)(u=i.g_sStopWords[r].toUpperCase(),u!==i.searchOr&&u!==i.searchAnd&&u!==i.searchNot)&&(n=n.replace(RegExp("(^|\\s)"+i.g_sStopWords[r]+"($|\\s)","ig")," "));return i.addAND(n.replace(/\s+/g," ").replace(/^\s+/g,"").replace(/\s+$/g,""))}},execute:function(){var h=this,i=h.engine,e,o,u,f,n;if(this.children==null){if(this.type!=0)for(e=i.getAliases(this.value),n=0;n<e.length;n++)this.docs=i.mergeDocs(this.docs,i.searchInIndex(e[n],!0));else this.docs=i.searchInIndex(this.value,this.type!=0);if(!this.docs&&!r(this.value)&&(o=s(this.value,i.g_sWords,!1),o!=this.value))for(u=o.split(" "),n=0;n<u.length;n++)if(this.type!=0||t(i.g_sStopWords,u[n])==-1){if(f=i.searchInIndex(u[n],!0),!f){this.docs=null;break}this.docs=this.docs?i.intersect(this.docs,f,!0):f}}else for(n=0;n<this.children.length;n++)if((this.type!=0||t(i.g_sStopWords,this.children[n].value)==-1)&&(this.children[n].execute()?this.docs=this.type==0||this.type==2?this.docs?i.intersect(this.docs,this.children[n].docs,this.type==0):this.children[n].docs:this.docs?i.mergeDocs(this.docs,this.children[n].docs):this.children[n].docs:(this.type!=1||n==0)&&(this.docs=null),this.docs==null&&this.type!=1))break;return this.not&&this.docs&&(this.docs=i.invert(this.docs)),this.docs!=null},getQueryString:function(n){var o=this,i=o.engine,f,t,e,r,u;if(this.children==null)return f=n&&this.type!=0&&!p(this.value)&&(!this.docs||this.docs.length<2)&&!i.aliasesHT[this.value]?i.getSimilarWord(this.value):this.value,this.not&&this.type!=0?i.searchNotInSpaces+f:f;for(t="",e=this.type==1?i.searchOrInSpaces:" ",r=0;r<this.children.length;r++)u=this.children[r].getQueryString(n),r==0?t=u:t+=this.children[r].not&&this.type==2?i.searchAndInSpaces+u:e+u;return this.type==0&&(t='"'+t+'"',this.not&&(t=i.searchNotInSpaces+t)),t},getWords:function(n){var u=this,o=u.engine,r,f,e,i;if(!this.children)return this.not||t(o.g_sStopWords,u.value)!=-1?[]:[u.value];for(r=[],f=[],i=0;i<u.children.length;i++)e=u.children[i].getWords(n),e.length&&(r[r.length]=e);if(n&&u.type===0)f[0]=r.join(" ");else for(i=0;i<r.length;i++)f=f.concat(r[i]);return f}},l?exports.engine=u:(nethelp.search.engine=u,nethelp.search.clause=i,nethelp.search.getWildcardRegexp=f)})()